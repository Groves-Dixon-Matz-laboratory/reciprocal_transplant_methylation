#set working dir#
setwd("~/gitreps/reciprocal_transplant_methylation/bisulfite_validation/")#
source("~/gitreps/reciprocal_transplant_methylation/scripts/bisulfite_functions.R")#
library(reshape)#
library(plotrix)#
#
#------------ UPLOAD THE BISULFITE DATA ------------##
#
#upload sample name spreadsheet#
snames = read.csv('data/sample_names.csv')#
#
#upload bismark data#
d = read.table('data/all_PE_bismark_results.tsv', sep="\t", header = T) #(see Bisulfite_amplicon_data_process_Walkthrough.txt to generate)#
head(snames)#
head(d)#
#------------ FILTER AND FORMAT THE BISULFITE DATA ------------##
#
#remove lines with fewer than 50 reads
sums=d$methReads + d$UnmethReads
sums
d0=d
d=d[sums>50,]
dim(d0)
dim(d)
head(d)
nrow(d)
4472-2450
